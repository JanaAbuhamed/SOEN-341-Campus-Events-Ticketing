{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ event.title }} • Event Details</title>
  <style>
    :root{
      --grad-start:#7b5cff; --grad-end:#ff3cac;
      --primary:#5c5cff; --primary-hover:#6a6aff;
      --chip:#eef2ff; --ok:#10b981; --warn:#f59e0b; --danger:#ef4444;
    }
    body{ margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:linear-gradient(135deg,var(--grad-start),var(--grad-end)); color:#111; }
    header{ color:#fff; padding:40px 16px 28px; text-align:center; }
    header h1{ margin:0 0 12px; font-size:2.1rem; font-weight:800; }
    .chipbar{ display:flex; justify-content:center; gap:12px; flex-wrap:wrap; }
    .chipbar a{ background:rgba(255,255,255,.22); color:#fff; text-decoration:none; padding:10px 16px; border-radius:999px; font-weight:700; }
    .chipbar a:hover{ background:rgba(255,255,255,.35); }

    main{ background:#f7f7fa; min-height:calc(100vh - 210px); border-radius:24px 24px 0 0; padding:28px 18px; }
    .card{ max-width:960px; margin:0 auto; background:#fff; border-radius:16px; box-shadow:0 8px 24px rgba(0,0,0,.06); padding:22px; }
    .meta-grid{ display:grid; grid-template-columns: 1fr 1fr; gap:16px; margin:12px 0 6px; }
    .item{ background:#fafafa; border:1px solid #eee; border-radius:12px; padding:12px 14px; }
    .item b{ display:block; font-size:.86rem; color:#555; margin-bottom:6px; }
    .availability{ margin:14px 0 8px; }
    .pill{ display:inline-block; font-weight:700; padding:6px 12px; border-radius:999px; }
    .pill.ok{ background:rgba(16,185,129,.12); color:var(--ok); }
    .pill.warn{ background:rgba(245,158,11,.12); color:var(--warn); }
    .pill.danger{ background:rgba(239,68,68,.12); color:var(--danger); }

    .actions{ display:flex; gap:12px; flex-wrap:wrap; margin-top:18px; }
    .btn{ border:none; border-radius:999px; padding:10px 18px; font-weight:800; cursor:pointer; text-decoration:none; }
    .btn-primary{ background:var(--primary); color:#fff; }
    .btn-primary:hover{ background:var(--primary-hover); }
    .btn-ghost{ background:#eef2ff; color:#3730a3; }
    .btn-disabled{ background:#e5e7eb; color:#6b7280; cursor:not-allowed; }

    .description{ margin-top:18px; line-height:1.6; color:#333; }
  </style>
</head>
<body>

<header>
  <h1>{{ event.title }}</h1>
  <div class="chipbar">
    <a href="{% url 'EventList' %}">← Back to events</a>
    <a href="{% url 'studentdashboard' %}">My Tickets</a>
  </div>
</header>

<main>
  <div class="card">
    <!-- Top meta -->
    <div class="meta-grid">
      <div class="item">
        <b>Date</b>
        <span>{{ event.date|date:"Y-m-d" }}</span>
      </div>
      <div class="item">
        <b>Time</b>
        <span>{{ event.time }}</span>
      </div>
      <div class="item">
        <b>Location</b>
        <span>{{ event.location }}</span>
      </div>
      <div class="item">
        <b>Organizer</b>
        <span>{{ event.organizer.name }}</span>
      </div>
      <div class="item">
        <b>Category</b>
        <span>{{ event.category }}</span>
      </div>
      <div class="item">
        <b>Ticket type</b>
        <span>{{ event.ticket_type|default:"free" }}</span>
      </div>
    </div>

    <!-- Availability -->
    <div class="availability">
      {% with spots=available cap=event.capacity %}
        {% if spots <= 0 %}
          <span class="pill danger">Sold out</span>
        {% elif spots <= 5 %}
          <span class="pill warn">{{ spots }} spot{{ spots|pluralize }} left</span>
        {% else %}
          <span class="pill ok">{{ spots }} spot{{ spots|pluralize }} left</span>
        {% endif %}
        <span style="margin-left:10px; color:#6b7280;">(Capacity: {{ cap }})</span>
      {% endwith %}
    </div>

    <!-- Description -->
    {% if event.description %}
      <div class="description">
        <b style="display:block; margin-bottom:6px; color:#555;">Description</b>
        <div>{{ event.description }}</div>
      </div>
    {% endif %}

    <!-- Actions -->
    <div class="actions">
      {% if is_claimed %}
        <span class="btn btn-disabled">Already claimed</span>
        <a class="btn btn-ghost" href="{% url 'studentdashboard' %}">Go to My Tickets</a>
      {% elif available <= 0 %}
        <span class="btn btn-disabled">Sold out</span>
      {% else %}
        {% if event.ticket_type == "paid" %}
          <a class="btn btn-primary" href="{% url 'checkout' event.id %}">Pay &amp; Claim</a>
        {% else %}
          <form method="post" action="{% url 'claim_event' event.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">Claim Ticket</button>
          </form>
        {% endif %}
      {% endif %}

      <!-- Save / Unsave -->
      <form method="post" action="{% url 'ToggleSaveEvent' event.id %}">
        {% csrf_token %}
        <input type="hidden" name="ref" value="detail">
        <button type="submit" class="btn btn-ghost">
          {% if is_saved %}Unsave{% else %}Save{% endif %}
        </button>
      </form>
    </div>
  </div>
</main>

</body>
</html>
